<%# Feedback panel component - User feedback form %>
<%# Usage: render "feedback/panel" %>

<div data-controller="feedback"
     data-feedback-submit-url-value="<%= feedbacks_path %>"
     data-feedback-open-value="false"
     class="chat-wrapper">

  <%# Floating orb toggle - glowing beacon %>
  <button type="button"
          class="chat-toggle-btn"
          data-action="click->feedback#toggle"
          aria-label="Send feedback">
    <span class="chat-toggle-glow"></span>
    <span class="chat-toggle-orb">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
    </span>
    <span class="chat-toggle-ripple"></span>
  </button>

  <%# Feedback panel - organic flowing design %>
  <div class="chat-panel hidden" data-feedback-target="panel">
    <%# Decorative background layers %>
    <div class="chat-panel-bg">
      <div class="chat-panel-grain"></div>
      <div class="chat-panel-gradient"></div>
    </div>

    <%# Header with curved organic shape %>
    <div class="chat-header">
      <div class="chat-header-curve"></div>
      <div class="chat-header-content">
        <div class="chat-header-identity">
          <div class="chat-avatar-ring">
            <div class="chat-avatar">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg>
            </div>
          </div>
          <div class="chat-header-text">
            <h3>Feedback</h3>
            <p class="chat-header-subtitle">Help us improve</p>
          </div>
        </div>
        <div class="chat-header-actions">
          <button type="button"
                  class="chat-action-btn chat-action-close"
                  data-action="click->feedback#close"
                  title="Close">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <%# Feedback form content %>
    <div class="chat-messages" data-feedback-target="content">
      <div class="feedback-intro">
        <p class="chat-greeting">We'd love to hear from you!</p>
        <p class="chat-prompt">Share your thoughts about this page or any suggestions you have.</p>
      </div>
    </div>

    <%# Success message (hidden by default) %>
    <div class="chat-messages hidden" data-feedback-target="success">
      <div class="feedback-success">
        <div class="feedback-success-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M20 6L9 17l-5-5"></path>
          </svg>
        </div>
        <p class="feedback-success-text">Thank you for your feedback!</p>
        <p class="feedback-success-subtext">We appreciate you taking the time to help us improve.</p>
      </div>
    </div>

    <%# Input area with elegant styling %>
    <form class="chat-form" data-feedback-target="form" data-action="submit->feedback#submit">
      <div class="feedback-field-group">
        <label for="feedback-email" class="feedback-label">Email (optional)</label>
        <input
          type="email"
          id="feedback-email"
          data-feedback-target="email"
          placeholder="your@email.com"
          class="feedback-input"
          autocomplete="email">
      </div>

      <div class="feedback-field-group">
        <label for="feedback-message" class="feedback-label">Your Feedback</label>
        <textarea
          id="feedback-message"
          data-feedback-target="message"
          data-action="input->feedback#updateCounter"
          placeholder="Tell us what you think about this page..."
          rows="4"
          class="feedback-textarea"
          required></textarea>
        <div class="feedback-counter">
          <span data-feedback-target="counter">0</span>/1000
        </div>
      </div>

      <button type="submit"
              class="btn-custom btn-custom-primary feedback-submit-btn"
              data-feedback-target="submitButton">
        Send Feedback
      </button>
    </form>
  </div>
</div>
