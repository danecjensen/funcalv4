<%= turbo_frame_tag dom_id(post) do %>
  <div class="card mb-3" id="<%= dom_id(post) %>">
    <div class="card-body">
      <div class="d-flex align-items-center mb-3">
        <%= render "shared/avatar", user: post.creator, size: 40 %>
        <div class="ms-2">
          <%= link_to post.creator.display_name, user_path(post.creator), class: "fw-bold text-decoration-none text-dark" %>
          <small class="text-muted d-block">
            <%= time_ago_in_words(post.created_at) %> ago
          </small>
        </div>
      </div>

      <div class="post-body mb-3">
        <%= post.body %>
      </div>

      <% if post.has_event? %>
        <%= render "events/card", event: post.event %>
      <% end %>

      <div class="post-actions pt-3 border-top d-flex align-items-center">
        <%= render "posts/like_button", post: post %>
        <span class="ms-4">
          <i class="bi bi-chat"></i>
          <%= post.comments_count %> comments
        </span>
        <% if policy(post).destroy? %>
          <span class="ms-auto">
            <%= link_to post_path(post), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "text-danger" do %>
              <i class="bi bi-trash"></i>
            <% end %>
          </span>
        <% end %>
      </div>

      <div class="comments-section mt-3" id="comments_<%= post.id %>">
        <%= render post.comments.includes(:creator).recent %>

        <% if user_signed_in? %>
          <%= render "comments/form", post: post, comment: Comment.new %>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
